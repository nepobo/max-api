# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - MAX API

## –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

‚úÖ –ü–æ–ª–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MAX Messenger API
‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏/–ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
‚úÖ –ü—Ä–∏–º–µ—Ä—ã –±–æ—Ç–æ–≤ (—ç—Ö–æ-–±–æ—Ç, –±–æ—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏)
‚úÖ –¢–µ—Å—Ç—ã
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### 1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd /home/nepobo/Myprojects/max-api
pip install -r requirements.txt
```

### 2Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://business.max.ru/self
2. –°–æ–∑–¥–∞–π—Ç–µ —á–∞—Ç-–±–æ—Ç–∞
3. –ü–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω"

### 3Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env

```bash
cp .env.example .env
```

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω:
```env
MAX_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å
```

### 4Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
python -m console_app.main
```

**–ú–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
- 1 ‚Üí –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- 2 ‚Üí –°–ª—É—à–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- 3 ‚Üí –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
- 4 ‚Üí –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- 0 ‚Üí –í—ã—Ö–æ–¥

### 5Ô∏è‚É£ –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä

**–≠—Ö–æ-–±–æ—Ç** (–ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è):
```bash
python examples/echo_bot.py
```

**–ë–æ—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏** (/start, /help, /info, /time):
```bash
python examples/simple_bot.py
```

**–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π:**
```bash
python examples/keyboard_example.py <chat_id>
```

### 6Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ

```python
from max_api import MAXClient
import os
from dotenv import load_dotenv

load_dotenv()

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
client = MAXClient(token=os.getenv('MAX_BOT_TOKEN'))

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ
bot = client.get_me()
print(f"–ë–æ—Ç: {bot['name']}")

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω—É–∂–µ–Ω user_id –ø–æ–ª—É—á–∞—Ç–µ–ª—è)
client.send_message(
    chat_id=123456789,  # user_id –ø–æ–ª—É—á–∞—Ç–µ–ª—è
    text="–ü—Ä–∏–≤–µ—Ç! üëã"
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
while True:
    updates = client.get_updates(timeout=30)
    
    for update in updates:
        if update.get('update_type') == 'message_created':
            message = update['message']
            sender = message['sender']
            
            # chat_id = user_id –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
            chat_id = sender['user_id']
            text = message['body']['text']
            
            print(f"–ü–æ–ª—É—á–µ–Ω–æ –æ—Ç {sender['name']}: {text}")
            client.send_message(chat_id=chat_id, text=f"–í—ã –Ω–∞–ø–∏—Å–∞–ª–∏: {text}")
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **QUICKSTART.md** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—á–∞–ª—É —Ä–∞–±–æ—Ç—ã
- **DEVELOPMENT_PLAN.md** - –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **PROJECT_SUMMARY.md** - –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ –ø—Ä–æ–µ–∫—Ç–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/

# –° –æ—Ç—á–µ—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
pytest tests/ --cov=max_api --cov-report=html
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
max-api/
‚îú‚îÄ‚îÄ max_api/              # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ client.py         # MAXClient - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py     # –ò—Å–∫–ª—é—á–µ–Ω–∏—è API
‚îÇ   ‚îî‚îÄ‚îÄ utils.py          # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ console_app/          # –ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ main.py           # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ examples/             # –ü—Ä–∏–º–µ—Ä—ã –±–æ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ echo_bot.py
‚îÇ   ‚îú‚îÄ‚îÄ simple_bot.py
‚îÇ   ‚îî‚îÄ‚îÄ keyboard_example.py
‚îî‚îÄ‚îÄ tests/                # –¢–µ—Å—Ç—ã
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### MAXClient

```python
client = MAXClient(token="YOUR_TOKEN")

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
bot = client.get_me()

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
client.send_message(chat_id=123, text="Hello")

# –° —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
client.send_message(chat_id=123, text="**Bold**", format="markdown")

# –° –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
from max_api.utils import build_inline_keyboard

keyboard = build_inline_keyboard([
    [{"type": "callback", "text": "–ö–Ω–æ–ø–∫–∞", "payload": "btn1"}]
])
client.send_message(chat_id=123, text="–í—ã–±–µ—Ä–∏—Ç–µ:", attachments=[keyboard])

# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (Long Polling)
updates = client.get_updates(timeout=30)

# Webhook
client.create_subscription(url="https://yourdomain.com/webhook")
```

## ‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞?**
A: –ù–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ https://business.max.ru/self –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –±–æ—Ç–∞.

**Q: –ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é?**
A: –í–∞–º –Ω—É–∂–µ–Ω chat_id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ–ª—É—á–∏—Ç–µ –µ–≥–æ –∏–∑ –≤—Ö–æ–¥—è—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.

**Q: –ü–æ—á–µ–º—É Long Polling?**
A: –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Webhook.

**Q: –ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É?**
A: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞ `message_callback`.

## üêõ –ü—Ä–æ–±–ª–µ–º—ã?

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –ø—Ä–æ—à—ë–ª –º–æ–¥–µ—Ä–∞—Ü–∏—é
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- [MAX API Docs](https://dev.max.ru/docs-api)
- [Chatbot Guide](https://dev.max.ru/docs/chatbots/bots-coding/prepare)
- [MAX Help](https://dev.max.ru/help)

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –ù–∞—á–Ω–∏—Ç–µ —Å –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–∏–º–µ—Ä–æ–≤.** üéâ

# ‚ÑπÔ∏è Long Polling Timeout - –≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û!

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –æ—à–∏–±–∫—É:
```
TimeoutError: The read operation timed out
–∏–ª–∏
MAXAPIException: –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (30s)
```

## ‚úÖ –≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û!

**Long Polling** —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
1. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä: "–ï—Å—Ç—å –ª–∏ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è?"
2. –°–µ—Ä–≤–µ—Ä **–∂–¥–µ—Ç –¥–æ 30 —Å–µ–∫—É–Ω–¥** –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
3. –ï—Å–ª–∏ –∑–∞ 30 —Å–µ–∫—É–Ω–¥ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–∏—à–ª–æ ‚Üí timeout
4. –ë–æ—Ç –¥–µ–ª–∞–µ—Ç –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏ —Å–Ω–æ–≤–∞ –∂–¥–µ—Ç

–≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **"Long Polling"** - –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.

## –ü–æ—á–µ–º—É —Ç–∞–∫ —Å–¥–µ–ª–∞–Ω–æ?

–≠—Ç–æ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, —á–µ–º –¥–µ–ª–∞—Ç—å —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É:
- ‚ùå –ü–ª–æ—Ö–æ: –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É (1000+ –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å)
- ‚úÖ –•–æ—Ä–æ—à–æ: –∂–¥–∞—Ç—å 30 —Å–µ–∫—É–Ω–¥ (120 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å)

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö

–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –±–æ—Ç–æ–≤ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç timeout**:

```python
try:
    while True:
        try:
            updates = client.get_updates(timeout=30, marker=last_marker)
        except Exception as e:
            # Long Polling timeout - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
            if "–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è" in str(e) or "timed out" in str(e).lower():
                continue  # –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∂–¥–∞—Ç—å
            else:
                print(f"–û—à–∏–±–∫–∞: {e}")
                time.sleep(5)
                continue
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        for update in updates:
            # ...
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
```
[00:00] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω, –∂–¥–µ–º...
[00:30] Timeout (–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π) ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
[01:00] Timeout (–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π) ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
[01:30] Timeout (–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π) ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä–∏—à–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
[00:00] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω, –∂–¥–µ–º...
[00:15] üì® –ü—Ä–∏—à–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–µ! ‚Üí –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏
[00:15] –°–Ω–æ–≤–∞ –∂–¥–µ–º...
[00:45] Timeout ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è production

–î–ª—è production-–æ–∫—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Webhook** –≤–º–µ—Å—Ç–æ Long Polling:

```python
# –í–º–µ—Å—Ç–æ get_updates() –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ webhook
client.create_subscription(
    url="https://yourdomain.com/webhook",
    update_types=["message_created", "message_callback"]
)
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Webhook:
- –°–µ—Ä–≤–µ—Ä **—Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–º—É –±–æ—Ç—É
- –ù–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ timeout'–æ–≤
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Long Polling:
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –±–æ—Ç—ã

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Webhook:
- ‚úÖ Production –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ –ë–æ—Ç—ã —Å –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞

## –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å timeout?

–ú–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å timeout –¥–æ 5-10 —Å–µ–∫—É–Ω–¥:

```python
# –í–º–µ—Å—Ç–æ 30 —Å–µ–∫—É–Ω–¥
updates = client.get_updates(timeout=30)

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 10 —Å–µ–∫—É–Ω–¥
updates = client.get_updates(timeout=10)
```

–ù–æ –ø–æ–º–Ω–∏—Ç–µ –æ –ª–∏–º–∏—Ç–µ **30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É**!

## –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å–µ–π—á–∞—Å

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ - timeout –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è:

```bash
python examples/echo_bot.py
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
```
–ë–æ—Ç '–£–ö –í–º–µ—Å—Ç–µ' –∑–∞–ø—É—â–µ–Ω!
–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π... (Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)
------------------------------------------------------------

# –ë–æ—Ç –∂–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è...
# Timeout –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!
# –ö–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–∞–ø–∏—à–µ—Ç–µ –±–æ—Ç—É - –æ–Ω —Å—Ä–∞–∑—É –æ—Ç–≤–µ—Ç–∏—Ç!
```

## –ò—Ç–æ–≥

‚úÖ Timeout –ø—Ä–∏ Long Polling - **—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**  
‚úÖ –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã  
‚úÖ –ë–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç timeout  
‚úÖ –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Webhook  

**–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ –∏ –ø–∏—à–∏—Ç–µ –µ–º—É –≤ MAX!** üöÄ

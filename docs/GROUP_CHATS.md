# –†–∞–±–æ—Ç–∞ —Å –≥—Ä—É–ø–ø–æ–≤—ã–º–∏ —á–∞—Ç–∞–º–∏ –≤ MAX Messenger

## –¢–∏–ø—ã —á–∞—Ç–æ–≤

–í MAX API —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ chat_id:

| –¢–∏–ø —á–∞—Ç–∞ | chat_id | –ü—Ä–∏–º–µ—Ä |
|----------|---------|--------|
| **–õ–∏—á–Ω—ã–π —á–∞—Ç** (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ | `12374848`, `206631906` |
| **–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç** | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ | `-987654321` |

## ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ

**–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –∏–∑ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ –±–æ—Ç –î–û–õ–ñ–ï–ù –±—ã—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º!**

–ë–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–æ—Ç –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å:
- ‚ùå –°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞
- ‚ùå –°–æ–±—ã—Ç–∏—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ
- ‚ùå –£–ø–æ–º–∏–Ω–∞–Ω–∏—è –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤

### 1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –≤ MAX Messenger
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞
3. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞

### 2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –±–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ –Ω–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞
2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –µ–º—É –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

## –ü–æ–ª—É—á–µ–Ω–∏–µ chat_id –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞

### –°–ø–æ—Å–æ–± 1: –ò–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```python
from max_api import MAXClient, UpdateManager

client = MAXClient(token="your_token")
manager = UpdateManager(client)

# –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
updates = manager.get_updates(timeout=30)

for update in updates:
    if update.get('update_type') == 'message_created':
        message = update['message']
        
        # –ü–æ–ª—É—á–∞—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è
        recipient = message['recipient']
        chat_id = recipient['chat_id']
        chat_type = recipient['chat_type']
        
        print(f"Chat ID: {chat_id}")  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –¥–ª—è –≥—Ä—É–ø–ø—ã
        print(f"Chat Type: {chat_type}")  # 'group' –∏–ª–∏ 'channel'
```

### –°–ø–æ—Å–æ–± 2: –ë–æ—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è chat_id

```python
from max_api import MAXClient, UpdateManager

client = MAXClient(token="your_token")
manager = UpdateManager(client)

print("–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç...")

while True:
    try:
        updates = manager.get_updates(timeout=30)
    except Exception as e:
        if "timeout" in str(e).lower():
            continue
    
    for update in updates:
        if update.get('update_type') == 'message_created':
            message = update['message']
            recipient = message['recipient']
            sender = message['sender']
            
            chat_id = recipient['chat_id']
            chat_type = recipient.get('chat_type', 'private')
            text = message.get('body', {}).get('text', '')
            
            if chat_id < 0:  # –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
                print(f"\nüìã –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –Ω–∞–π–¥–µ–Ω!")
                print(f"   Chat ID: {chat_id}")
                print(f"   Chat Type: {chat_type}")
                print(f"   –°–æ–æ–±—â–µ–Ω–∏–µ: {text}")
                print(f"   –û—Ç: {sender['name']}")
                
                # –û—Ç–≤–µ—Ç –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
                client.send_message(
                    chat_id=chat_id,
                    text=f"–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç ID: {chat_id}"
                )
```

## –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

### –õ–∏—á–Ω—ã–π —á–∞—Ç (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π chat_id)

```python
from max_api import MAXClient

client = MAXClient(token="your_token")

# –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
client.send_message(
    chat_id=12374848,  # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ
    text="–ü—Ä–∏–≤–µ—Ç!"
)
```

### –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π chat_id)

```python
from max_api import MAXClient

client = MAXClient(token="your_token")

# –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≥—Ä—É–ø–ø—É
client.send_message(
    chat_id=-987654321,  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ
    text="–ü—Ä–∏–≤–µ—Ç –≥—Ä—É–ø–ø–µ!"
)
```

## –†–∞–∑–ª–∏—á–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

```python
# –õ–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
{
    "sender": {
        "user_id": 12374848,  # –ö—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª
        "name": "–ò–≤–∞–Ω"
    },
    "recipient": {
        "chat_id": 206631906,  # ID –±–æ—Ç–∞ (–ø–æ–ª—É—á–∞—Ç–µ–ª—å)
        "chat_type": "private"
    },
    "body": {"text": "–ü—Ä–∏–≤–µ—Ç"}
}

# –°–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã
{
    "sender": {
        "user_id": 12374848,  # –ö—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª
        "name": "–ò–≤–∞–Ω"
    },
    "recipient": {
        "chat_id": -987654321,  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ID –≥—Ä—É–ø–ø—ã
        "chat_type": "group"
    },
    "body": {"text": "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º"}
}
```

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —á–∞—Ç–∞

```python
def handle_message(message):
    recipient = message['recipient']
    chat_id = recipient['chat_id']
    chat_type = recipient.get('chat_type', 'private')
    
    if chat_id < 0:
        # –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
        print(f"–°–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã {chat_id}")
        # –û—Å–æ–±–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –≥—Ä—É–ø–ø
    else:
        # –õ–∏—á–Ω—ã–π —á–∞—Ç
        print(f"–õ–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {chat_id}")
        # –û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```

### –û—Ç–≤–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —á–∞—Ç–∞

```python
from max_api import MAXClient

def reply_to_message(client, message):
    recipient = message['recipient']
    sender = message['sender']
    text = message['body']['text']
    
    chat_id = recipient['chat_id']
    
    if chat_id < 0:
        # –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç - –º–æ–∂–Ω–æ —É–ø–æ–º—è–Ω—É—Ç—å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        response = f"@{sender['username']}, –ø–æ–ª—É—á–µ–Ω–æ: {text}"
        client.send_message(chat_id=chat_id, text=response)
    else:
        # –õ–∏—á–Ω—ã–π —á–∞—Ç - –æ–±—ã—á–Ω—ã–π –æ—Ç–≤–µ—Ç
        response = f"–ü–æ–ª—É—á–µ–Ω–æ: {text}"
        client.send_message(chat_id=chat_id, text=response)
```

## –ü—Ä–∏–º–µ—Ä –±–æ—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä—É–ø–ø–∞–º–∏

```python
from max_api import MAXClient, UpdateManager, UpdateMode
import os

client = MAXClient(token=os.getenv('MAX_BOT_TOKEN'))
manager = UpdateManager(client, mode=UpdateMode.LONG_POLLING)

bot_info = client.get_me()
print(f"–ë–æ—Ç '{bot_info['name']}' –∑–∞–ø—É—â–µ–Ω")
print("–ù–µ –∑–∞–±—É–¥—å—Ç–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –±–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö!")

while True:
    try:
        updates = manager.get_updates(timeout=30)
    except Exception as e:
        if "timeout" in str(e).lower():
            continue
        print(f"–û—à–∏–±–∫–∞: {e}")
        continue
    
    for update in updates:
        if update.get('update_type') == 'message_created':
            message = update['message']
            
            sender = message['sender']
            recipient = message['recipient']
            body = message.get('body', {})
            
            chat_id = recipient['chat_id']
            chat_type = recipient.get('chat_type', 'private')
            text = body.get('text', '')
            
            sender_name = sender.get('name', 'Unknown')
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —á–∞—Ç–∞
            is_group = chat_id < 0
            chat_label = "–≥—Ä—É–ø–ø–∞" if is_group else "–ª–∏—á–∫–∞"
            
            print(f"[{chat_label}] {sender_name}: {text}")
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
            if text.startswith('/'):
                command = text.split()[0]
                
                if command == '/start':
                    response = f"–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ {'–≥—Ä—É–ø–ø–æ–≤–æ–π' if is_group else '–ª–∏—á–Ω—ã–π'} —á–∞—Ç"
                    client.send_message(chat_id=chat_id, text=response)
                
                elif command == '/chatid':
                    response = f"Chat ID: {chat_id}\n–¢–∏–ø: {chat_type}"
                    client.send_message(chat_id=chat_id, text=response)
            
            else:
                # –≠—Ö–æ
                response = f"–≠—Ö–æ: {text}"
                client.send_message(chat_id=chat_id, text=response)
```

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ë–æ—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –≥—Ä—É–ø–ø—ã

**–ü—Ä–∏—á–∏–Ω–∞**: –ë–æ—Ç –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

**–†–µ—à–µ–Ω–∏–µ**: 
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£—á–∞—Å—Ç–Ω–∏–∫–∏
3. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞
4. –ù–∞–∑–Ω–∞—á—å—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

### ‚ùå –û—à–∏–±–∫–∞ "–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π chat_id" –¥–ª—è –≥—Ä—É–ø–ø—ã

**–ü—Ä–∏—á–∏–Ω–∞**: –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ chat_id

**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
```bash
pip install --upgrade git+https://github.com/nepobo/max-api.git
```

### ‚ùå –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–µ –≤ —Ç—É –≥—Ä—É–ø–ø—É

**–ü—Ä–∏—á–∏–Ω–∞**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π chat_id

**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `recipient['chat_id']` –¥–ª—è –æ—Ç–≤–µ—Ç–∞:
```python
chat_id = message['recipient']['chat_id']  # –ü–†–ê–í–ò–õ–¨–ù–û
# –ù–ï sender['user_id'] –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤!
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–∏–ø —á–∞—Ç–∞

```python
def get_reply_chat_id(message):
    """–ü–æ–ª—É—á–∏—Ç—å chat_id –¥–ª—è –æ—Ç–≤–µ—Ç–∞"""
    return message['recipient']['chat_id']
```

### ‚úÖ –õ–æ–≥–∏—Ä—É–π—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Ç–µ

```python
chat_id = recipient['chat_id']
chat_type = recipient.get('chat_type', 'private')
is_group = chat_id < 0

logger.info(f"Message from {'group' if is_group else 'user'} {chat_id}")
```

### ‚úÖ –†–∞–∑–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –≥—Ä—É–ø–ø –∏ –ª–∏—á–Ω—ã—Ö —á–∞—Ç–æ–≤

```python
if chat_id < 0:
    # –ì—Ä—É–ø–ø–æ–≤–∞—è –ª–æ–≥–∏–∫–∞: –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    handle_group_message(message)
else:
    # –õ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞: –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω
    handle_private_message(message)
```

## –†–µ–∑—é–º–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –õ–∏—á–Ω—ã–π —á–∞—Ç | –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç |
|----------|-----------|---------------|
| **chat_id** | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π |
| **chat_type** | `"private"` | `"group"` –∏–ª–∏ `"channel"` |
| **–ü—Ä–∞–≤–∞ –±–æ—Ç–∞** | –ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è | **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!** |
| **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä |
| **–û—Ç–≤–µ—Ç** | `sender['user_id']` –∏–ª–∏ `recipient['chat_id']` | `recipient['chat_id']` |

**üéØ –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ**: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä—É–ø–ø–æ–≤—ã–º–∏ —á–∞—Ç–∞–º–∏ –±–æ—Ç –î–û–õ–ñ–ï–ù –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º!
